[build]
  command = "npm run build"
  publish = ".next"
  # Install sharp avec support Linux pour Netlify
  environment = { NPM_FLAGS = "--include=optional" }

# Configuration pour le déploiement automatique
[build.environment]
  NODE_VERSION = "20"
  NPM_VERSION = "10"

[[plugins]]
  package = "@netlify/plugin-nextjs"

# Configuration pour Next.js API routes
# IMPORTANT: Même avec le plan Pro, le timeout maximum est de 50 secondes
# Le code utilise un timeout de 45s pour laisser une marge de sécurité
# Si vous avez besoin de plus de temps, contactez le support Netlify
# Alternative: Utiliser Background Functions pour les opérations longues

[functions]
  # Configuration pour les fonctions Netlify (si utilisées)
  # Le timeout est configuré dans le code à 45s pour éviter le timeout Netlify (50s)

# Configuration pour le déploiement continu
# Netlify déploiera automatiquement à chaque push sur la branche main
[context.production]
  command = "npm run build"
  publish = ".next"

[context.branch-deploy]
  command = "npm run build"
  publish = ".next"
